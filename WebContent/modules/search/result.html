<p />
<button class="btn btn-default"
		ui-sref="openSearch">
		&#x25c0;&#x25c0;	{{'Back to searches'|translate}}
</button>



<button class="btn btn-default"
		ui-sref="search({id:resultCtrl.result.searchid})">
	 &#x25c0; {{'Adjust parameters'|translate}}
</button>



<br/>
<h3>{{'Searchresult'|translate}}</h3>
<p />
<br/>


<div ng-switch on="resultCtrl.result.type">


<!--  Case 1: search for a sample -->
<table ng-switch-when="1" class="table" >
	<thead class=parametertablehead>
		<tr>
			<td> {{'object'|translate}} </td>
			<td ng-repeat="col in resultCtrl.result.headings" ng-click="resultCtrl.sortBy($index)">
				<span ng-show="resultCtrl.currentSortColumn==$index && resultCtrl.currentSortDirection== 1"> &#9660; </span>
				<span ng-show="resultCtrl.currentSortColumn==$index && resultCtrl.currentSortDirection==-1"> &#9650; </span>
			 	{{col.namef()}} {{col.unitf()?'(':''}}{{col.unitf()}}{{col.unitf()?')':''}}
			</td>
		</tr>
	</thead>
	<tbody>
		<tr ng-repeat="row in resultCtrl.result.data">
			<td> <a ui-sref="sample({sampleID:row.id})">{{resultCtrl.getType(row.type)}} {{row.name}} </a> </td>
			<td ng-repeat="col in row.rowdata track by $index">
			 	<tparameter parameter="col"></tparameter>
			</td>
		</tr>
	</tbody>
</table>


<!--  Case 2: search for a property/process -->
<table ng-switch-when="2" class="table" >
	<thead class=parametertablehead>
		<tr>
			<td> {{'property'|translate}} </td>
			<td ng-repeat="col in resultCtrl.result.headings" ng-click="resultCtrl.sortBy($index)">
				<span ng-show="resultCtrl.currentSortColumn==$index && resultCtrl.currentSortDirection== 1"> &#9660; </span>
				<span ng-show="resultCtrl.currentSortColumn==$index && resultCtrl.currentSortDirection==-1"> &#9650; </span>
			 	{{col.namef()}} {{col.unitf()?'(':''}}{{col.unitf()}}{{col.unitf()?')':''}}
			</td>
		</tr>
	</thead>
	<tbody>
		<tr ng-repeat="row in resultCtrl.result.data">
			<td> <a ui-sref="process({processID:row.id})">{{resultCtrl.getProcessType(row.type)}} {{row.name}} </a> </td>
			<td ng-repeat="col in row.rowdata track by $index">
			 	<tparameter parameter="col"></tparameter>
			</td>
		</tr>
	</tbody>
</table>


<!--  Case 3: search for a property specific parameter -->
<table ng-switch-when="3" class="table" >
	<thead class=parametertablehead>
		<tr>
			<td> {{'property'|translate}} </td>
			<td ng-repeat="col in resultCtrl.result.headings" ng-click="resultCtrl.sortBy($index)">
				<span ng-show="resultCtrl.currentSortColumn==$index && resultCtrl.currentSortDirection== 1"> &#9660; </span>
				<span ng-show="resultCtrl.currentSortColumn==$index && resultCtrl.currentSortDirection==-1"> &#9650; </span>
			 	{{col.namef()}} {{col.unitf()?'(':''}}{{col.unitf()}}{{col.unitf()?')':''}}
			</td>
		</tr>
	</thead>
	<tbody>
		<tr ng-repeat="row in resultCtrl.result.data">
			<td> <a ui-sref="process({processID:row.id})">{{resultCtrl.getProcessType(row.type)}} {{row.name}} </a> </td>
			<td ng-repeat="col in row.rowdata track by $index">
			 	<tparameter parameter="col"></tparameter>
			</td>
		</tr>
	</tbody>
</table>


<!--  Case 4: combined search for a property and a sample -->
<table ng-switch-when="4" class="table" >
	<thead class=parametertablehead>
		<tr>
			<td> {{'object'|translate}} </td>
			<td ng-repeat="col in resultCtrl.result.headings"  ng-click="resultCtrl.sortBy($index+1)">
				<span ng-show="resultCtrl.currentSortColumn==$index+1 && resultCtrl.currentSortDirection== 1"> &#9660; </span>
				<span ng-show="resultCtrl.currentSortColumn==$index+1 && resultCtrl.currentSortDirection==-1"> &#9650; </span>
			 	{{col.namef()}} {{col.unitf()?'(':''}}{{col.unitf()}}{{col.unitf()?')':''}}
			</td>
		</tr>
	</thead>
	<tbody>
	 	<tr ng-repeat="row in resultCtrl.processedArray">
	 		<td ng-repeat="datacolumn in row track by $index">
	 			<a ng-show="$index==0 && resultCtrl.processedArray[$parent.$index-1][0].id!=row[0].id" ui-sref="sample({sampleID:datacolumn.id})">{{resultCtrl.getType(datacolumn.type)}} {{datacolumn.name}}</a>
	 			<!-- && resultCtrl.processedArray[$parent.$index-1][0].id!=datacolumn[0].id -->
	 			<div ng-hide="$index==0 || ($index<resultCtrl.sampleDataLength && resultCtrl.processedArray[$parent.$index-1][0].id==row[0].id)">{{datacolumn}}</div>
	 		</td>		
		</tr>
	</tbody>
</table>
</div>


<br/>
<button class="btn btn-default"
		ng-click="resultCtrl.saveCSV()">
	 {{'Save as .csv'|translate}}
</button>


<!-- 
<button class="btn btn-default"
		ng-click="resultCtrl.saveExcel()">
	 {{'Save as .xls'|translate}}
</button>
 -->
<br/>
<br/>
<br/>
<br/>

